# CIAN Full Apartment Pipeline → PostgreSQL

## О проекте

Этот проект — полный ETL-конвейер для работы с данными квартир с сайта **CIAN**:

1. **Парсинг** всей информации о квартирах.
2. **Удаление дубликатов**.
3. **Нормализация адресов**.
4. **Геокодирование адресов** (получение координат).
5. **Форматирование координат** (приведение к нужному формату).
6. **Расчёт расстояний до центра**.
7. **Загрузка данных в PostgreSQL** через **SQLAlchemy**.
8. **Очистка временных файлов**.

Пайплайн имеет встроенные **чекпоинты**: если выполнение прервалось, при следующем запуске он продолжит с последнего завершённого шага. Логи пишутся в файл `pipeline.log` и дублируются в консоль.

---

## Этапы пайплайна

| № | Этап                     | Файл/Функция                                       |
|---|--------------------------|----------------------------------------------------|
| 1 | Сбор данных с CIAN       | `parsing/html_parser.py` → `array()`               |
| 2 | Удаление дубликатов      | `data_processing/removing_duplicates.py` → `rem_dubl()` |
| 3 | Нормализация адресов     | `data_processing/ref_address.py` → `rename_address()` |
| 4 | Геокодирование           | `geo_processing/geo_coders.py` → `run_geo()`       |
| 5 | Форматирование координат | `data_processing/ref_coordinates.py` → `ref_coor()` |
| 6 | Расчёт расстояний        | `geo_processing/distance_to_center.py` → `update_datasets_with_distances()` |
| 7 | Загрузка в PostgreSQL    | `database/db_manager.py` → `DatabaseManager.append_all_cities()` |
| 8 | Очистка папки `data`     | `_clean_data_folder()`                             |
